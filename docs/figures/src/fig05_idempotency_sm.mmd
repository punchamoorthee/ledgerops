%%{init: {"theme":"neutral","themeVariables":{
  "fontFamily":"Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto",
  "primaryColor":"#40826D","primaryBorderColor":"#40826D","primaryTextColor":"#0a0a0a",
  "lineColor":"#40826D","tertiaryColor":"#ffffff"}}}%%
stateDiagram-v2
  direction LR

  [*] --> New
  New --> In_Progress: POST(K)<br/>!exists(K)
  In_Progress --> In_Progress: GET /transfers/{id}<br/>returns 202
  In_Progress --> Completed: process and commit<br/>store response
  In_Progress --> In_Progress: POST(K)<br/>exists && in_progress → 409
  Completed --> Completed: GET /transfers/{id}<br/>returns 200
  Completed --> Completed: POST(K)<br/>exists && completed → 200 (replay)
  Completed --> Expired: TTL elapsed
  Expired --> [*]
